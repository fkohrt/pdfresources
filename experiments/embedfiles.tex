% !Mode:: "TeX:UTF-8:Main"
\RequirePackage{pdfresources}
\DeclareDocumentMetaData{pdfversion=1.6}
\documentclass{article}
\usepackage{pdfresources}
\usepackage{l3pdffile}
\usepackage[customdriver=hgeneric-experimental]{hyperref}
\hypersetup{pdfversion=1.6,pdfpagemode=UseAttachments}
\ExplSyntaxOn
\pdf_uncompress:
\ExplSyntaxOff
\usepackage{bookmark}
\begin{document}
\section{grüße Testing embedding and attaching files}
\ExplSyntaxOn
%\pdftool_textlitstring_print:nN {xxxgrüße}\l_tmpa_str
%\pdfextension outline goto name {Doc-Start}{\l_tmpa_str}
\group_begin:
\pdfdict_put:nnn  {file/FileSpec} {AFRelationship}{/Source}
\pdfdict_put:nnn  {file/FileSpec} {Desc}{(this~is~a~eps)}
%\pdfdict_show:n   {file/FileSpec}
%\pdffile_embed:nn {example}{grüße.txt}
%\pdffile_attach:n {example}
\group_end:

\group_begin:
\pdfdict_put:nnn  {file/FileSpec} {AFRelationship}{/Source}
\pdfdict_put:nnn  {file/FileSpec} {Desc}{(this~is~a~eps)}
\pdffile_embed_file:nnn {example-image.eps}{blub.txt}{example1}
%\pdffile_attach:n {example2}
\group_end:
%
\group_begin:
\pdfdict_put:nnn  {file/FileSpec} {AFRelationship}{/Data}
\pdfdict_put:nnn  {file/FileSpec} {Desc}{(this~is~a~text~file)}
\pdffile_embed_file:nnn {testinput.txt} {} {example2}
\pdffile_attach:n {example2}
\group_end:

\group_begin:
\pdfdict_put:nnn  {file/FileSpec} {AFRelationship}{/Data}
\pdfdict_put:nnn  {file/FileSpec} {Desc}{(this~is~only~a~filespec)}
\pdffile_embed_file:nnn {} {testinput.txt} {example4}
\pdffile_embed_file:nnn {} {testinput.txt} {example4}

\pdffile_attach:n {example4} %not a good idea doesn't work.
\group_end:

\end{document}

%
\group_begin:
\pdfdict_put:nnn  {file/FileSpec} {AFRelationship}{/Source}
\pdfdict_put:nnn  {file/FileSpec} {Desc}{(this~is~a~tex~file)}
\pdffile_embed:nn  {tex} {links.tex}
\pdffile_attach:nN {tex}\l_tmpa_tl
\group_end:

\ExplSyntaxOff

\end{document}
