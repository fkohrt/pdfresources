\input{regression-test}
\PassOptionsToPackage{debug}{pdfmanagement}
\RequirePackage{pdfmanagement}
\DeclareDocumentMetadata { }
\documentclass{article}

\usepackage{hyperxmp,lipsum}

\usepackage[customdriver=hgeneric-experimental,
   ocgcolorlinks]
   {hyperref}

\hypersetup{  pdftoolbar=false,
   pdfauthor={Ulrike Fischer},
   pdftitle={A test of metadata},
   pdfnonfullscreenpagemode=UseNone,
   pdfnumcopies=4,
   pdfpagelayout=SinglePage
   }


\ExplSyntaxOn
\pdf_object_new:nn{metadata-obj}{stream}
\pdfmanagement_add:nnx {Catalog} {Metadata}{\pdf_object_ref:n{metadata-obj}}
\ExplSyntaxOff

 \begin{document}
 blblb \lipsum
 \ExplSyntaxOn\makeatletter
 \hyxmp@construct@packet
 \exp_args:Nnx\pdf_object_write:nn{metadata-obj}{{/Type~/Metadata~/Subtype~/XML}{\hyxmp@xml}}%
\ExplSyntaxOff
\end{document}
