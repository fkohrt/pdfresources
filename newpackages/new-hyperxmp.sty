%% !!!!!!!!!!!!!!!! not an up-to-date copy!!!!!!!!
%%
%% This is file `new-hyperxmp.sty',
\NeedsTeXFormat{LaTeX2e}[1999/12/01]
\ProvidesPackage{new-hyperxmp}
    [2020/12/02 v0.2 Store hyperref metadata in XMP format / testing pdfresource management ...UF]

\RequirePackage{hyperxmp}

\ExplSyntaxOn

\cs_if_exist:NT \pdfmanagement_add:nnn
  {
    \pdfmanagement_if_active:T
     {
       \renewcommand\hyxmp@embed@packet{\hyxmp@embed@packet@generic}
     }
  }

% uncompressed stream??
\newcommand*{\hyxmp@embed@packet@generic}
 {%
   \typeout{}
   \typeout{!!~new-hyperxmp--generic~packet~command~used!!}{}
   \typeout{}
   \hyxmp@construct@packet
   \exp_args:Nnx
    \pdf_object_now:nn{stream}{{/Type~/Metadata~/Subtype~/XML}{\hyxmp@xml}}%
    \pdfmanagement_add:nnx {Catalog} {Metadata}{\pdf_object_last:}
 }
\ExplSyntaxOff


\endinput
