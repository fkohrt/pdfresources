\input{regression-test}
\documentclass{article}
\RequirePackage{pdfresources}
\usepackage{l3pdf}
\usepackage{zref-user}
\ExplSyntaxOn
\pdf_uncompress:
\ExplSyntaxOff
\makeatletter
\def\myrotate#1{\ifodd\zref@extractdefault{#1}{page}{0} -90\else 90 \fi}
\makeatother
\begin{document}
\START
\showoutput
\makeatletter
\ExplSyntaxOn
\Huge TEXT

\begin{figure}[p]
\zlabel{a}\label{a}
\pdfdict_put:nnx{Page}{Rotate}{\myrotate{a}}
\Huge
code~is~on~page~\thepage\par
float~is~on~page~\zpageref{a}\par
\rule{1cm}{10cm}
\end{figure}

\begin{figure}[p]
\zlabel{b}
\pdfdict_put:nnx{Page}{Rotate}{\myrotate{b}}
\Huge
code~is~on~page~\thepage\par
\label{b}float~is~on~page~\pageref{b}\par
\rule{1cm}{10cm}
\end{figure}

\end{document} 